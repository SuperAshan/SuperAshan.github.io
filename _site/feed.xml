<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.6.2">Jekyll</generator><link href="http://localhost:4000/blog/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/blog/" rel="alternate" type="text/html" /><updated>2017-12-10T12:07:27+08:00</updated><id>http://localhost:4000/blog/</id><title type="html">Clean Blog</title><subtitle>A Blog Theme by Start Bootstrap</subtitle><author><name>Start Bootstrap</name></author><entry><title type="html">Man must explore, and this is exploration at its greatest</title><link href="http://localhost:4000/blog/2017/10/31/man-must-explore.html" rel="alternate" type="text/html" title="Man must explore, and this is exploration at its greatest" /><published>2017-10-31T22:45:13+08:00</published><updated>2017-10-31T22:45:13+08:00</updated><id>http://localhost:4000/blog/2017/10/31/man-must-explore</id><content type="html" xml:base="http://localhost:4000/blog/2017/10/31/man-must-explore.html">&lt;p&gt;Never in all their history have men been able truly to conceive of the world as one: a single sphere, a globe, having the qualities of a globe, a round earth in which all the directions eventually meet, in which there is no center because every point, or none, is center — an equal earth which all men occupy as equals. The airman's earth, if free men make it, will be truly round: a globe in practice, not in theory.&lt;/p&gt;

&lt;p&gt;Science cuts two ways, of course; its products can be used for both good and evil. But there's no turning back from science. The early warnings about technological dangers also come from science.&lt;/p&gt;

&lt;p&gt;What was most significant about the lunar voyage was not that man set foot on the Moon but that they set eye on the earth.&lt;/p&gt;

&lt;p&gt;A Chinese tale tells of some men sent to harm a young girl who, upon seeing her beauty, become her protectors rather than her violators. That's how I felt seeing the Earth for the first time. I could not help but love and cherish her.&lt;/p&gt;

&lt;p&gt;For those who have seen the Earth from space, and for the hundreds and perhaps thousands more who will, the experience most certainly changes your perspective. The things that we share in our world are far more valuable than those which divide us.&lt;/p&gt;

&lt;h2 class=&quot;section-heading&quot;&gt;The Final Frontier&lt;/h2&gt;

&lt;p&gt;There can be no thought of finishing for ‘aiming for the stars.’ Both figuratively and literally, it is a task to occupy the generations. And no matter how much progress one makes, there is always the thrill of just beginning.&lt;/p&gt;

&lt;p&gt;There can be no thought of finishing for ‘aiming for the stars.’ Both figuratively and literally, it is a task to occupy the generations. And no matter how much progress one makes, there is always the thrill of just beginning.&lt;/p&gt;

&lt;blockquote class=&quot;blockquote&quot;&gt;The dreams of yesterday are the hopes of today and the reality of tomorrow. Science has not yet mastered prophecy. We predict too much for the next year and yet far too little for the next ten.&lt;/blockquote&gt;

&lt;p&gt;Spaceflights cannot be stopped. This is not the work of any one man or even a group of men. It is a historical process which mankind is carrying out in accordance with the natural laws of human development.&lt;/p&gt;

&lt;h2 class=&quot;section-heading&quot;&gt;Reaching for the Stars&lt;/h2&gt;

&lt;p&gt;As we got further and further away, it [the Earth] diminished in size. Finally it shrank to the size of a marble, the most beautiful you can imagine. That beautiful, warm, living object looked so fragile, so delicate, that if you touched it with a finger it would crumble and fall apart. Seeing this has to change a man.&lt;/p&gt;

&lt;img class=&quot;img-fluid&quot; src=&quot;https://source.unsplash.com/Mn9Fa_wQH-M/800x450&quot; alt=&quot;Demo Image&quot;&gt;
&lt;span class=&quot;caption text-muted&quot;&gt;To go places and do things that have never been done before – that’s what living is all about.&lt;/span&gt;

&lt;p&gt;Space, the final frontier. These are the voyages of the Starship Enterprise. Its five-year mission: to explore strange new worlds, to seek out new life and new civilizations, to boldly go where no man has gone before.&lt;/p&gt;

&lt;p&gt;As I stand out here in the wonders of the unknown at Hadley, I sort of realize there’s a fundamental truth to our nature, Man must explore, and this is exploration at its greatest.&lt;/p&gt;

&lt;p&gt;Placeholder text by &lt;a href=&quot;http://spaceipsum.com/&quot;&gt;Space Ipsum&lt;/a&gt;. Photographs by &lt;a href=&quot;https://unsplash.com/&quot;&gt;Unsplash&lt;/a&gt;.&lt;/p&gt;</content><author><name>Start Bootstrap</name></author><summary type="html">Never in all their history have men been able truly to conceive of the world as one: a single sphere, a globe, having the qualities of a globe, a round earth in which all the directions eventually meet, in which there is no center because every point, or none, is center — an equal earth which all men occupy as equals. The airman's earth, if free men make it, will be truly round: a globe in practice, not in theory.</summary></entry><entry><title type="html">第一篇博客测试</title><link href="http://localhost:4000/blog/2017/10/31/first-blog.html" rel="alternate" type="text/html" title="第一篇博客测试" /><published>2017-10-31T22:45:13+08:00</published><updated>2017-10-31T22:45:13+08:00</updated><id>http://localhost:4000/blog/2017/10/31/first-blog</id><content type="html" xml:base="http://localhost:4000/blog/2017/10/31/first-blog.html">&lt;p&gt;我的个人博客上线了．
我的测试&lt;/p&gt;</content><author><name>Start Bootstrap</name></author><summary type="html">我的个人博客上线了． 我的测试</summary></entry><entry><title type="html">I believe every human has a finite number of heartbeats. I don’t intend to waste any of mine.</title><link href="http://localhost:4000/blog/2017/10/30/heartbeats.html" rel="alternate" type="text/html" title="I believe every human has a finite number of heartbeats. I don't intend to waste any of mine." /><published>2017-10-31T11:45:13+08:00</published><updated>2017-10-31T11:45:13+08:00</updated><id>http://localhost:4000/blog/2017/10/30/heartbeats</id><content type="html" xml:base="http://localhost:4000/blog/2017/10/30/heartbeats.html">&lt;p&gt;Never in all their history have men been able truly to conceive of the world as one: a single sphere, a globe, having the qualities of a globe, a round earth in which all the directions eventually meet, in which there is no center because every point, or none, is center — an equal earth which all men occupy as equals. The airman's earth, if free men make it, will be truly round: a globe in practice, not in theory.&lt;/p&gt;

&lt;p&gt;Science cuts two ways, of course; its products can be used for both good and evil. But there's no turning back from science. The early warnings about technological dangers also come from science.&lt;/p&gt;

&lt;p&gt;What was most significant about the lunar voyage was not that man set foot on the Moon but that they set eye on the earth.&lt;/p&gt;

&lt;p&gt;A Chinese tale tells of some men sent to harm a young girl who, upon seeing her beauty, become her protectors rather than her violators. That's how I felt seeing the Earth for the first time. I could not help but love and cherish her.&lt;/p&gt;

&lt;p&gt;For those who have seen the Earth from space, and for the hundreds and perhaps thousands more who will, the experience most certainly changes your perspective. The things that we share in our world are far more valuable than those which divide us.&lt;/p&gt;

&lt;h2 class=&quot;section-heading&quot;&gt;The Final Frontier&lt;/h2&gt;

&lt;p&gt;There can be no thought of finishing for ‘aiming for the stars.’ Both figuratively and literally, it is a task to occupy the generations. And no matter how much progress one makes, there is always the thrill of just beginning.&lt;/p&gt;

&lt;p&gt;There can be no thought of finishing for ‘aiming for the stars.’ Both figuratively and literally, it is a task to occupy the generations. And no matter how much progress one makes, there is always the thrill of just beginning.&lt;/p&gt;

&lt;blockquote class=&quot;blockquote&quot;&gt;The dreams of yesterday are the hopes of today and the reality of tomorrow. Science has not yet mastered prophecy. We predict too much for the next year and yet far too little for the next ten.&lt;/blockquote&gt;

&lt;p&gt;Spaceflights cannot be stopped. This is not the work of any one man or even a group of men. It is a historical process which mankind is carrying out in accordance with the natural laws of human development.&lt;/p&gt;

&lt;h2 class=&quot;section-heading&quot;&gt;Reaching for the Stars&lt;/h2&gt;

&lt;p&gt;As we got further and further away, it [the Earth] diminished in size. Finally it shrank to the size of a marble, the most beautiful you can imagine. That beautiful, warm, living object looked so fragile, so delicate, that if you touched it with a finger it would crumble and fall apart. Seeing this has to change a man.&lt;/p&gt;

&lt;img class=&quot;img-fluid&quot; src=&quot;https://source.unsplash.com/Mn9Fa_wQH-M/800x450&quot; alt=&quot;Demo Image&quot;&gt;
&lt;span class=&quot;caption text-muted&quot;&gt;To go places and do things that have never been done before – that’s what living is all about.&lt;/span&gt;

&lt;p&gt;Space, the final frontier. These are the voyages of the Starship Enterprise. Its five-year mission: to explore strange new worlds, to seek out new life and new civilizations, to boldly go where no man has gone before.&lt;/p&gt;

&lt;p&gt;As I stand out here in the wonders of the unknown at Hadley, I sort of realize there’s a fundamental truth to our nature, Man must explore, and this is exploration at its greatest.&lt;/p&gt;

&lt;p&gt;Placeholder text by &lt;a href=&quot;http://spaceipsum.com/&quot;&gt;Space Ipsum&lt;/a&gt;. Photographs by &lt;a href=&quot;https://unsplash.com/&quot;&gt;Unsplash&lt;/a&gt;.&lt;/p&gt;</content><author><name>Start Bootstrap</name></author><summary type="html">Never in all their history have men been able truly to conceive of the world as one: a single sphere, a globe, having the qualities of a globe, a round earth in which all the directions eventually meet, in which there is no center because every point, or none, is center — an equal earth which all men occupy as equals. The airman's earth, if free men make it, will be truly round: a globe in practice, not in theory.</summary></entry><entry><title type="html">Science has not yet mastered prophecy</title><link href="http://localhost:4000/blog/2017/10/29/prophecy.html" rel="alternate" type="text/html" title="Science has not yet mastered prophecy" /><published>2017-10-30T11:45:13+08:00</published><updated>2017-10-30T11:45:13+08:00</updated><id>http://localhost:4000/blog/2017/10/29/prophecy</id><content type="html" xml:base="http://localhost:4000/blog/2017/10/29/prophecy.html">&lt;p&gt;Never in all their history have men been able truly to conceive of the world as one: a single sphere, a globe, having the qualities of a globe, a round earth in which all the directions eventually meet, in which there is no center because every point, or none, is center — an equal earth which all men occupy as equals. The airman's earth, if free men make it, will be truly round: a globe in practice, not in theory.&lt;/p&gt;

&lt;p&gt;Science cuts two ways, of course; its products can be used for both good and evil. But there's no turning back from science. The early warnings about technological dangers also come from science.&lt;/p&gt;

&lt;p&gt;What was most significant about the lunar voyage was not that man set foot on the Moon but that they set eye on the earth.&lt;/p&gt;

&lt;p&gt;A Chinese tale tells of some men sent to harm a young girl who, upon seeing her beauty, become her protectors rather than her violators. That's how I felt seeing the Earth for the first time. I could not help but love and cherish her.&lt;/p&gt;

&lt;p&gt;For those who have seen the Earth from space, and for the hundreds and perhaps thousands more who will, the experience most certainly changes your perspective. The things that we share in our world are far more valuable than those which divide us.&lt;/p&gt;

&lt;h2 class=&quot;section-heading&quot;&gt;The Final Frontier&lt;/h2&gt;

&lt;p&gt;There can be no thought of finishing for ‘aiming for the stars.’ Both figuratively and literally, it is a task to occupy the generations. And no matter how much progress one makes, there is always the thrill of just beginning.&lt;/p&gt;

&lt;p&gt;There can be no thought of finishing for ‘aiming for the stars.’ Both figuratively and literally, it is a task to occupy the generations. And no matter how much progress one makes, there is always the thrill of just beginning.&lt;/p&gt;

&lt;blockquote class=&quot;blockquote&quot;&gt;The dreams of yesterday are the hopes of today and the reality of tomorrow. Science has not yet mastered prophecy. We predict too much for the next year and yet far too little for the next ten.&lt;/blockquote&gt;

&lt;p&gt;Spaceflights cannot be stopped. This is not the work of any one man or even a group of men. It is a historical process which mankind is carrying out in accordance with the natural laws of human development.&lt;/p&gt;

&lt;h2 class=&quot;section-heading&quot;&gt;Reaching for the Stars&lt;/h2&gt;

&lt;p&gt;As we got further and further away, it [the Earth] diminished in size. Finally it shrank to the size of a marble, the most beautiful you can imagine. That beautiful, warm, living object looked so fragile, so delicate, that if you touched it with a finger it would crumble and fall apart. Seeing this has to change a man.&lt;/p&gt;

&lt;img class=&quot;img-fluid&quot; src=&quot;https://source.unsplash.com/Mn9Fa_wQH-M/800x450&quot; alt=&quot;Demo Image&quot;&gt;
&lt;span class=&quot;caption text-muted&quot;&gt;To go places and do things that have never been done before – that’s what living is all about.&lt;/span&gt;

&lt;p&gt;Space, the final frontier. These are the voyages of the Starship Enterprise. Its five-year mission: to explore strange new worlds, to seek out new life and new civilizations, to boldly go where no man has gone before.&lt;/p&gt;

&lt;p&gt;As I stand out here in the wonders of the unknown at Hadley, I sort of realize there’s a fundamental truth to our nature, Man must explore, and this is exploration at its greatest.&lt;/p&gt;

&lt;p&gt;Placeholder text by &lt;a href=&quot;http://spaceipsum.com/&quot;&gt;Space Ipsum&lt;/a&gt;. Photographs by &lt;a href=&quot;https://unsplash.com/&quot;&gt;Unsplash&lt;/a&gt;.&lt;/p&gt;</content><author><name>Start Bootstrap</name></author><summary type="html">Never in all their history have men been able truly to conceive of the world as one: a single sphere, a globe, having the qualities of a globe, a round earth in which all the directions eventually meet, in which there is no center because every point, or none, is center — an equal earth which all men occupy as equals. The airman's earth, if free men make it, will be truly round: a globe in practice, not in theory.</summary></entry><entry><title type="html">Failure is not an option</title><link href="http://localhost:4000/blog/2017/10/28/exploration.html" rel="alternate" type="text/html" title="Failure is not an option" /><published>2017-10-29T11:45:13+08:00</published><updated>2017-10-29T11:45:13+08:00</updated><id>http://localhost:4000/blog/2017/10/28/exploration</id><content type="html" xml:base="http://localhost:4000/blog/2017/10/28/exploration.html">&lt;p&gt;Never in all their history have men been able truly to conceive of the world as one: a single sphere, a globe, having the qualities of a globe, a round earth in which all the directions eventually meet, in which there is no center because every point, or none, is center — an equal earth which all men occupy as equals. The airman's earth, if free men make it, will be truly round: a globe in practice, not in theory.&lt;/p&gt;

&lt;p&gt;Science cuts two ways, of course; its products can be used for both good and evil. But there's no turning back from science. The early warnings about technological dangers also come from science.&lt;/p&gt;

&lt;p&gt;What was most significant about the lunar voyage was not that man set foot on the Moon but that they set eye on the earth.&lt;/p&gt;

&lt;p&gt;A Chinese tale tells of some men sent to harm a young girl who, upon seeing her beauty, become her protectors rather than her violators. That's how I felt seeing the Earth for the first time. I could not help but love and cherish her.&lt;/p&gt;

&lt;p&gt;For those who have seen the Earth from space, and for the hundreds and perhaps thousands more who will, the experience most certainly changes your perspective. The things that we share in our world are far more valuable than those which divide us.&lt;/p&gt;

&lt;h2 class=&quot;section-heading&quot;&gt;The Final Frontier&lt;/h2&gt;

&lt;p&gt;There can be no thought of finishing for ‘aiming for the stars.’ Both figuratively and literally, it is a task to occupy the generations. And no matter how much progress one makes, there is always the thrill of just beginning.&lt;/p&gt;

&lt;p&gt;There can be no thought of finishing for ‘aiming for the stars.’ Both figuratively and literally, it is a task to occupy the generations. And no matter how much progress one makes, there is always the thrill of just beginning.&lt;/p&gt;

&lt;blockquote class=&quot;blockquote&quot;&gt;The dreams of yesterday are the hopes of today and the reality of tomorrow. Science has not yet mastered prophecy. We predict too much for the next year and yet far too little for the next ten.&lt;/blockquote&gt;

&lt;p&gt;Spaceflights cannot be stopped. This is not the work of any one man or even a group of men. It is a historical process which mankind is carrying out in accordance with the natural laws of human development.&lt;/p&gt;

&lt;h2 class=&quot;section-heading&quot;&gt;Reaching for the Stars&lt;/h2&gt;

&lt;p&gt;As we got further and further away, it [the Earth] diminished in size. Finally it shrank to the size of a marble, the most beautiful you can imagine. That beautiful, warm, living object looked so fragile, so delicate, that if you touched it with a finger it would crumble and fall apart. Seeing this has to change a man.&lt;/p&gt;

&lt;img class=&quot;img-fluid&quot; src=&quot;https://source.unsplash.com/Mn9Fa_wQH-M/800x450&quot; alt=&quot;Demo Image&quot;&gt;
&lt;span class=&quot;caption text-muted&quot;&gt;To go places and do things that have never been done before – that’s what living is all about.&lt;/span&gt;

&lt;p&gt;Space, the final frontier. These are the voyages of the Starship Enterprise. Its five-year mission: to explore strange new worlds, to seek out new life and new civilizations, to boldly go where no man has gone before.&lt;/p&gt;

&lt;p&gt;As I stand out here in the wonders of the unknown at Hadley, I sort of realize there’s a fundamental truth to our nature, Man must explore, and this is exploration at its greatest.&lt;/p&gt;

&lt;p&gt;Placeholder text by &lt;a href=&quot;http://spaceipsum.com/&quot;&gt;Space Ipsum&lt;/a&gt;. Photographs by &lt;a href=&quot;https://unsplash.com/&quot;&gt;Unsplash&lt;/a&gt;.&lt;/p&gt;</content><author><name>Start Bootstrap</name></author><summary type="html">Never in all their history have men been able truly to conceive of the world as one: a single sphere, a globe, having the qualities of a globe, a round earth in which all the directions eventually meet, in which there is no center because every point, or none, is center — an equal earth which all men occupy as equals. The airman's earth, if free men make it, will be truly round: a globe in practice, not in theory.</summary></entry><entry><title type="html">The dreams of yesterday are the hopes of today and the reality of tomorrow.</title><link href="http://localhost:4000/blog/2017/10/27/dreams.html" rel="alternate" type="text/html" title="The dreams of yesterday are the hopes of today and the reality of tomorrow." /><published>2017-10-28T11:45:13+08:00</published><updated>2017-10-28T11:45:13+08:00</updated><id>http://localhost:4000/blog/2017/10/27/dreams</id><content type="html" xml:base="http://localhost:4000/blog/2017/10/27/dreams.html">&lt;p&gt;Never in all their history have men been able truly to conceive of the world as one: a single sphere, a globe, having the qualities of a globe, a round earth in which all the directions eventually meet, in which there is no center because every point, or none, is center — an equal earth which all men occupy as equals. The airman's earth, if free men make it, will be truly round: a globe in practice, not in theory.&lt;/p&gt;

&lt;p&gt;Science cuts two ways, of course; its products can be used for both good and evil. But there's no turning back from science. The early warnings about technological dangers also come from science.&lt;/p&gt;

&lt;p&gt;What was most significant about the lunar voyage was not that man set foot on the Moon but that they set eye on the earth.&lt;/p&gt;

&lt;p&gt;A Chinese tale tells of some men sent to harm a young girl who, upon seeing her beauty, become her protectors rather than her violators. That's how I felt seeing the Earth for the first time. I could not help but love and cherish her.&lt;/p&gt;

&lt;p&gt;For those who have seen the Earth from space, and for the hundreds and perhaps thousands more who will, the experience most certainly changes your perspective. The things that we share in our world are far more valuable than those which divide us.&lt;/p&gt;

&lt;h2 class=&quot;section-heading&quot;&gt;The Final Frontier&lt;/h2&gt;

&lt;p&gt;There can be no thought of finishing for ‘aiming for the stars.’ Both figuratively and literally, it is a task to occupy the generations. And no matter how much progress one makes, there is always the thrill of just beginning.&lt;/p&gt;

&lt;p&gt;There can be no thought of finishing for ‘aiming for the stars.’ Both figuratively and literally, it is a task to occupy the generations. And no matter how much progress one makes, there is always the thrill of just beginning.&lt;/p&gt;

&lt;blockquote class=&quot;blockquote&quot;&gt;The dreams of yesterday are the hopes of today and the reality of tomorrow. Science has not yet mastered prophecy. We predict too much for the next year and yet far too little for the next ten.&lt;/blockquote&gt;

&lt;p&gt;Spaceflights cannot be stopped. This is not the work of any one man or even a group of men. It is a historical process which mankind is carrying out in accordance with the natural laws of human development.&lt;/p&gt;

&lt;h2 class=&quot;section-heading&quot;&gt;Reaching for the Stars&lt;/h2&gt;

&lt;p&gt;As we got further and further away, it [the Earth] diminished in size. Finally it shrank to the size of a marble, the most beautiful you can imagine. That beautiful, warm, living object looked so fragile, so delicate, that if you touched it with a finger it would crumble and fall apart. Seeing this has to change a man.&lt;/p&gt;

&lt;img class=&quot;img-fluid&quot; src=&quot;https://source.unsplash.com/Mn9Fa_wQH-M/800x450&quot; alt=&quot;Demo Image&quot;&gt;
&lt;span class=&quot;caption text-muted&quot;&gt;To go places and do things that have never been done before – that’s what living is all about.&lt;/span&gt;

&lt;p&gt;Space, the final frontier. These are the voyages of the Starship Enterprise. Its five-year mission: to explore strange new worlds, to seek out new life and new civilizations, to boldly go where no man has gone before.&lt;/p&gt;

&lt;p&gt;As I stand out here in the wonders of the unknown at Hadley, I sort of realize there’s a fundamental truth to our nature, Man must explore, and this is exploration at its greatest.&lt;/p&gt;

&lt;p&gt;Placeholder text by &lt;a href=&quot;http://spaceipsum.com/&quot;&gt;Space Ipsum&lt;/a&gt;. Photographs by &lt;a href=&quot;https://unsplash.com/&quot;&gt;Unsplash&lt;/a&gt;.&lt;/p&gt;</content><author><name>Start Bootstrap</name></author><summary type="html">Never in all their history have men been able truly to conceive of the world as one: a single sphere, a globe, having the qualities of a globe, a round earth in which all the directions eventually meet, in which there is no center because every point, or none, is center — an equal earth which all men occupy as equals. The airman's earth, if free men make it, will be truly round: a globe in practice, not in theory.</summary></entry><entry><title type="html">Dinosaurs are extinct today</title><link href="http://localhost:4000/blog/2017/10/26/dinosaurs.html" rel="alternate" type="text/html" title="Dinosaurs are extinct today" /><published>2017-10-27T11:45:13+08:00</published><updated>2017-10-27T11:45:13+08:00</updated><id>http://localhost:4000/blog/2017/10/26/dinosaurs</id><content type="html" xml:base="http://localhost:4000/blog/2017/10/26/dinosaurs.html">&lt;p&gt;Never in all their history have men been able truly to conceive of the world as one: a single sphere, a globe, having the qualities of a globe, a round earth in which all the directions eventually meet, in which there is no center because every point, or none, is center — an equal earth which all men occupy as equals. The airman's earth, if free men make it, will be truly round: a globe in practice, not in theory.&lt;/p&gt;

&lt;p&gt;Science cuts two ways, of course; its products can be used for both good and evil. But there's no turning back from science. The early warnings about technological dangers also come from science.&lt;/p&gt;

&lt;p&gt;What was most significant about the lunar voyage was not that man set foot on the Moon but that they set eye on the earth.&lt;/p&gt;

&lt;p&gt;A Chinese tale tells of some men sent to harm a young girl who, upon seeing her beauty, become her protectors rather than her violators. That's how I felt seeing the Earth for the first time. I could not help but love and cherish her.&lt;/p&gt;

&lt;p&gt;For those who have seen the Earth from space, and for the hundreds and perhaps thousands more who will, the experience most certainly changes your perspective. The things that we share in our world are far more valuable than those which divide us.&lt;/p&gt;

&lt;h2 class=&quot;section-heading&quot;&gt;The Final Frontier&lt;/h2&gt;

&lt;p&gt;There can be no thought of finishing for ‘aiming for the stars.’ Both figuratively and literally, it is a task to occupy the generations. And no matter how much progress one makes, there is always the thrill of just beginning.&lt;/p&gt;

&lt;p&gt;There can be no thought of finishing for ‘aiming for the stars.’ Both figuratively and literally, it is a task to occupy the generations. And no matter how much progress one makes, there is always the thrill of just beginning.&lt;/p&gt;

&lt;blockquote class=&quot;blockquote&quot;&gt;The dreams of yesterday are the hopes of today and the reality of tomorrow. Science has not yet mastered prophecy. We predict too much for the next year and yet far too little for the next ten.&lt;/blockquote&gt;

&lt;p&gt;Spaceflights cannot be stopped. This is not the work of any one man or even a group of men. It is a historical process which mankind is carrying out in accordance with the natural laws of human development.&lt;/p&gt;

&lt;h2 class=&quot;section-heading&quot;&gt;Reaching for the Stars&lt;/h2&gt;

&lt;p&gt;As we got further and further away, it [the Earth] diminished in size. Finally it shrank to the size of a marble, the most beautiful you can imagine. That beautiful, warm, living object looked so fragile, so delicate, that if you touched it with a finger it would crumble and fall apart. Seeing this has to change a man.&lt;/p&gt;

&lt;img class=&quot;img-fluid&quot; src=&quot;https://source.unsplash.com/Mn9Fa_wQH-M/800x450&quot; alt=&quot;Demo Image&quot;&gt;
&lt;span class=&quot;caption text-muted&quot;&gt;To go places and do things that have never been done before – that’s what living is all about.&lt;/span&gt;

&lt;p&gt;Space, the final frontier. These are the voyages of the Starship Enterprise. Its five-year mission: to explore strange new worlds, to seek out new life and new civilizations, to boldly go where no man has gone before.&lt;/p&gt;

&lt;p&gt;As I stand out here in the wonders of the unknown at Hadley, I sort of realize there’s a fundamental truth to our nature, Man must explore, and this is exploration at its greatest.&lt;/p&gt;

&lt;p&gt;Placeholder text by &lt;a href=&quot;http://spaceipsum.com/&quot;&gt;Space Ipsum&lt;/a&gt;. Photographs by &lt;a href=&quot;https://unsplash.com/&quot;&gt;Unsplash&lt;/a&gt;.&lt;/p&gt;</content><author><name>Start Bootstrap</name></author><summary type="html">Never in all their history have men been able truly to conceive of the world as one: a single sphere, a globe, having the qualities of a globe, a round earth in which all the directions eventually meet, in which there is no center because every point, or none, is center — an equal earth which all men occupy as equals. The airman's earth, if free men make it, will be truly round: a globe in practice, not in theory.</summary></entry><entry><title type="html">源码阅读系列之textrank</title><link href="http://localhost:4000/blog/blog/2017/02/21/textrank%E8%A7%A3%E8%AF%BB.html" rel="alternate" type="text/html" title="源码阅读系列之textrank" /><published>2017-02-21T00:00:00+08:00</published><updated>2017-02-21T00:00:00+08:00</updated><id>http://localhost:4000/blog/blog/2017/02/21/textrank%E8%A7%A3%E8%AF%BB</id><content type="html" xml:base="http://localhost:4000/blog/blog/2017/02/21/textrank%E8%A7%A3%E8%AF%BB.html">&lt;blockquote&gt;
  &lt;p&gt;最近在看一些自动摘要的东西，总结一下分为抽取式和生成式，其中抽取式的比较简单的一种是textrank.textrank其实也是提取关键词的一种比较方便的方式:具体原理为将句子组织成图，然后在图上运行pagerank算法。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;网上有一个源码，用起来挺方便,叫TextRank4zh。看起来挺简单就看了一遍。
Textrank下面有四个文件:Segmentation.py主要用于切词和切句子，TextRAnk4Keyword.py主要用于提取关键词，TextRank4Sentence.py主要抽取关键的句子。util.py主要是关键词和句子排序。&lt;/p&gt;

&lt;p&gt;先看提取关键词:
TextRank4Keyword
&lt;strong&gt;init&lt;/strong&gt;.初始化.可以在stopword.txt中添加停止词
进入主函数analyze中，传入参数包括要进行提取的原文，关键词边的窗口大小，是够都变为小写,节点的类型选项（影响分词结果),边的类型，pagerank的参数。&lt;/p&gt;

&lt;p&gt;首先分词result = self.seg.segment(text=text, lower=lower).分词函数在Segmentation中.Segmentation初始化两个级别的分词项,WordSegmentation,SentenceSegmentation,词级别和句子级别。句子通过util.delimiters直接切割，然后词语切割直接调用结巴分词，具体结巴分词介绍可以参照:&lt;a href=&quot;https://superashan.github.io/blog/2016/06/15/jieba%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB.html&quot; title=&quot;源码阅读之jieba分词&quot;&gt;源码阅读之结巴分词&lt;/a&gt;。
分词的时候通过allow_speech_tags控制生成词语的词性，返回的结果为dict，嵌套三层结构。第一层为选项，主要是是否使用停用词，和是否使用词性过滤两种，第二层对应句子，每个句子为word_list.&lt;/p&gt;

&lt;p&gt;分词之后就进行图的构造，图构造然后排序函数为:util.sort_words.进入util.py文件中，sort_words函数中，首先是构造图:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;for word_list in _vertex_source:
    for word in word_list:
        if not word in word_index:
            word_index[word] = words_number
            index_word[words_number] = word
            words_number += 1

graph = np.zeros((words_number, words_number))

for word_list in _edge_source:
    for w1, w2 in combine(word_list, window):
        if w1 in word_index and w2 in word_index:
            index1 = word_index[w1]
            index2 = word_index[w2]
            graph[index1][index2] = 1.0 
            graph[index2][index1] = 1.0 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;其中combine是构造边的函数，combine函数:
combine函数为word_list,中窗口window中的word之间有边。&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;def combine(word_list, window = 2):
    &quot;&quot;&quot;构造在window下的单词组合，用来构造单词之间的边。

    Keyword arguments:
    word_list  --  list of str, 由单词组成的列表。
    windows    --  int, 窗口大小。
    &quot;&quot;&quot;
    if window &amp;lt; 2: window = 2
    for x in xrange(1, window):
        if x &amp;gt;= len(word_list):
            break
        word_list2 = word_list[x:]
        res = zip(word_list, word_list2)
        for r in res:
            yield r
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;构造好图矩阵之后，调用pagerank算法，使用Python中的模块networkx：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;nx_graph = nx.from_numpy_matrix(graph)
scores = nx.pagerank(nx_graph, **pagerank_config)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;结果为排好序的节点（即词语)&lt;/p&gt;

&lt;p&gt;提取关键句子，（自动摘由抽取式的)&lt;/p&gt;

&lt;p&gt;流程和提取关键词的流程完全一致,只不过构造图的时候边的权重为两个句子的相似度，两个句子相似度函数为getsimmi&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;def get_similarity(word_list1, word_list2):
    &quot;&quot;&quot;默认的用于计算两个句子相似度的函数。

    Keyword arguments:
    word_list1, word_list2  --  分别代表两个句子，都是由单词组成的列表
    &quot;&quot;&quot;
    words   = list(set(word_list1 + word_list2))
    vector1 = [float(word_list1.count(word)) for word in words]
    vector2 = [float(word_list2.count(word)) for word in words]

    vector3 = [vector1[x]*vector2[x]  for x in xrange(len(vector1))]
    vector4 = [1 for num in vector3 if num &amp;gt; 0.]
    co_occur_num = sum(vector4)

    if abs(co_occur_num) &amp;lt;= 1e-12:
        return 0.

    denominator = math.log(float(len(word_list1))) + math.log(float(len(word_list2))) # 分母

    if abs(denominator) &amp;lt; 1e-12:
        return 0.

    return co_occur_num / denominator
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;公式为: co_word_num/(log(list1num)+log(list2num))&lt;/p&gt;

&lt;p&gt;改进的方法：
根据pagerank的算法，可以改进的地方就是图的边，词语之间，句子之间的权重，可以使用word2vector训练得到词向量，结合位置关系计算他们之间的关系。&lt;/p&gt;</content><author><name>Start Bootstrap</name></author><category term="textrank" /><category term="关键词" /><category term="关键词提取" /><category term="关键句子提取" /><category term="自动摘要" /><category term="摘要生成" /><summary type="html">“主要是解读textrank算法在关键词抽取方面的应用，同时解析了textrank4zh的源码”</summary></entry><entry><title type="html">工作笔记之一：猜你喜欢模块</title><link href="http://localhost:4000/blog/blog/2017/01/13/guesswantquery.html" rel="alternate" type="text/html" title="工作笔记之一：猜你喜欢模块" /><published>2017-01-13T00:00:00+08:00</published><updated>2017-01-13T00:00:00+08:00</updated><id>http://localhost:4000/blog/blog/2017/01/13/guesswantquery</id><content type="html" xml:base="http://localhost:4000/blog/blog/2017/01/13/guesswantquery.html">&lt;p&gt;##猜你喜欢&lt;/p&gt;

&lt;p&gt;推荐语料为搜索query，目标为提升搜索量，提升用户搜索体验，分解一下为推出的query为相关和惊喜度，+热门
整体方案如下：
&lt;img src=&quot;http://superashan.github.io/images/guesswantquery/structure.png&quot; alt=&quot;猜你喜欢数据流程图&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;召回阶段&quot;&gt;###召回阶段&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;1. 种子集合&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;搜索的query，按照搜索的频度可以分为经常搜索的和最近搜索的query&lt;/li&gt;
  &lt;li&gt;用户的画像(可以根据用户的其他行为),最好对于用户总结关键词，tag，类别等分层次的行为&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;2. 扩展候选集合&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;扩展可以根据item-base,query之间的关系扩展&lt;/li&gt;
  &lt;li&gt;扩展可以根据用户的关键词图谱召回相关query&lt;/li&gt;
  &lt;li&gt;扩展可以通过tag和类别召回惊喜度较高的query&lt;/li&gt;
  &lt;li&gt;有些词语不进行扩展，专门的词库:天气，彩票，双色球等等&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;3.低质量过滤&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;第一层为query的UV过滤
    &lt;ul&gt;
      &lt;li&gt;uv过滤根据query的搜索UV，删掉搜索人数比较少的query，砍掉80%的query&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;第二层基于词表的过滤
    &lt;ul&gt;
      &lt;li&gt;&lt;strong&gt;全量匹配&lt;/strong&gt;：全量是硬匹配，一些事件，人物，垃圾词等等。“蛤蛤怒斥香港女记者”，“身度完整版”，“6080神马影院”，“东条希本子”&lt;/li&gt;
      &lt;li&gt;&lt;strong&gt;部分匹配&lt;/strong&gt;:一些垃圾词，色情，隐私等&lt;/li&gt;
      &lt;li&gt;&lt;strong&gt;乱码&lt;/strong&gt;：可能是韩文，日文，搜索日志中的乱码。&lt;/li&gt;
      &lt;li&gt;&lt;strong&gt;政治敏感词&lt;/strong&gt;:政治敏感词库不能出&lt;/li&gt;
      &lt;li&gt;&lt;strong&gt;竞品词&lt;/strong&gt;：不让出的&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;第二层为基于libshorttxt的二分类模型
    &lt;ul&gt;
      &lt;li&gt;以字为特征，构造正例和负例。其中正例为热门中的正常query。负例为匹配出来的query，两边都是1万&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;4.去重&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;由于用户本身搜索的query表明的意思比较集中，则通过扩展构造的query集合大量重复的query，这种大量重复的query影响了用户体验。所以需要去重逻辑，保证推出的query的多样性&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;第一层去重逻辑为长词的归一化&lt;/p&gt;

    &lt;p&gt;归一化的目的是合并一些表明一个意思的词语到一个意思，类似于query聚类，然后去类的中心点。聚类通过query的点击url的关系来实现，实现方法是将点击一个url（这个url必须是落地页面）的query中找到一个keyquery，keyquery的计算方法是用query的点击次数/query的长度，然后将二者的关系作为key,value,相同的key选value最大的为keyquery&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;归一化比较规范的:
        &lt;ul&gt;
          &lt;li&gt;00后时髦小女生图片  REPLACE 00后小美女/2.4&lt;/li&gt;
          &lt;li&gt;贷视频流出 REPLACE 裸贷肉偿视频遭疯传/8.5 不同地方热点事件归一化到最规范的说法&lt;/li&gt;
          &lt;li&gt;12360下载官方下载手机版 REPLACE 12360下载/175.111111111&lt;/li&gt;
          &lt;li&gt;qq飞车星光秀场怎么进去  REPLACE 星光秀场/114.75&lt;/li&gt;
          &lt;li&gt;奥运会项目有哪些    REPLACE 奥运会/55.6&lt;/li&gt;
          &lt;li&gt;芭比公主之美人鱼的故事  REPLACE 美人鱼故事/4.6&lt;/li&gt;
          &lt;li&gt;八零后副厅  REPLACE 王玺玮的父亲/4.0&lt;/li&gt;
          &lt;li&gt;保卫萝卜2攻略108攻略水晶萝卜头  REPLACE 保卫萝卜108/3.63636363636&lt;/li&gt;
          &lt;li&gt;保卫部落3d策略塔防  REPLACE 保卫部落/4.0&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;也有代表并不正确：
        &lt;ul&gt;
          &lt;li&gt;07excel箭头在哪 REPLACE excel绘图工具在哪/3.64705882353&lt;/li&gt;
          &lt;li&gt;09年君威    REPLACE 09年君威二手车价格/478.75&lt;/li&gt;
          &lt;li&gt;0p手机剩余电量怎么设置  REPLACE 小米手机电量百分比/7.88888888889&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;第二层为一些case的规则:
    &lt;ul&gt;
      &lt;li&gt;比如说对小说多个章节，电影多个系列的合并，通过正则表达式[\d]+?字，部，章等
        &lt;ul&gt;
          &lt;li&gt;三妹53集        NEW:三妹&lt;/li&gt;
          &lt;li&gt;小雄的故事1864章        NEW:小雄的故事&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;根据一些词语切割，取前面的意思：
        &lt;ul&gt;
          &lt;li&gt;OLD:0852蟹总完整版     NEW:0852蟹总&lt;/li&gt;
          &lt;li&gt;OLD:2345影视大全       NEW:2345影视&lt;/li&gt;
          &lt;li&gt;gta5秘籍大全       NEW:gta5秘籍&lt;/li&gt;
          &lt;li&gt;傲世掌控txt下载    NEW:傲世掌控&lt;/li&gt;
          &lt;li&gt;爱莎美瞳官网       NEW:爱莎美瞳&lt;/li&gt;
          &lt;li&gt;霸皇下载   NEW:霸皇&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;针对小说漫画，针对用户构成，对小说，漫画单独处理，根据小说的名字，漫画的名字，每个中最多出两个:
        &lt;ul&gt;
          &lt;li&gt;择天记电视剧-择天记&lt;/li&gt;
          &lt;li&gt;
            &lt;table&gt;
              &lt;tbody&gt;
                &lt;tr&gt;
                  &lt;td&gt;偷香高手&lt;/td&gt;
                  &lt;td&gt; &lt;/td&gt;
                  &lt;td&gt;5&lt;/td&gt;
                  &lt;td&gt; &lt;/td&gt;
                  &lt;td&gt;0.13032&lt;/td&gt;
                  &lt;td&gt; &lt;/td&gt;
                  &lt;td&gt;712   偷香高手类似的&lt;/td&gt;
                &lt;/tr&gt;
              &lt;/tbody&gt;
            &lt;/table&gt;
          &lt;/li&gt;
          &lt;li&gt;绝世兵王五十二策  绝世兵王&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;包含关系
        &lt;ul&gt;
          &lt;li&gt;包含关系留下UV大的&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;第三层是根据一些字面的意思：但是query1+query2的长度必须小于9，不做处理，错误率比较高
    &lt;ul&gt;
      &lt;li&gt;字集合的jaccad系数和提取关键词的集合jaccad系数(关键词定义为&lt;strong&gt;&lt;em&gt;名词，动词，成语，关键词&lt;/em&gt;&lt;/strong&gt;集合中的jaccard系数)
        &lt;ul&gt;
          &lt;li&gt;&lt;strong&gt;正确的&lt;/strong&gt;
            &lt;ul&gt;
              &lt;li&gt;6s运行内存多大    苹果运行内存多大        0.750   0.750&lt;/li&gt;
              &lt;li&gt;dmi指标详解       dmi指标详解视频 0.778   0.778&lt;/li&gt;
              &lt;li&gt;阿笠博士的幕后故事        阿笠博士幕后故事17&lt;/li&gt;
              &lt;li&gt;穿越火线乔杉电影  穿越火线电影    0.750   0.750&lt;/li&gt;
              &lt;li&gt;初中生综合素质评价        初中生综合素质评语&lt;/li&gt;
              &lt;li&gt;荣耀magic视频     荣耀magic       0.778   0.778&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;&lt;strong&gt;错误的&lt;/strong&gt;
            &lt;ul&gt;
              &lt;li&gt;超级农场  超级农场主      0.800   0.800&lt;/li&gt;
              &lt;li&gt;大明星的贴身护卫  大小姐的贴身护卫        0.750   0.750&lt;/li&gt;
              &lt;li&gt;都市仙君  都市大仙君      0.800   0.800&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;语义层面的去重，通过wordtovector训练term之间的关系，主要解决的问题是短文本，query1+query2的长度&amp;lt;9的词语，一些明显关联度比较高的&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;
        &lt;table&gt;
          &lt;tbody&gt;
            &lt;tr&gt;
              &lt;td&gt;羽衣传说&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;5&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;0.20555&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;1373–羽衣传说目录&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;5&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;0.20319&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;1715      0.816&lt;/td&gt;
            &lt;/tr&gt;
          &lt;/tbody&gt;
        &lt;/table&gt;
      &lt;/li&gt;
      &lt;li&gt;
        &lt;table&gt;
          &lt;tbody&gt;
            &lt;tr&gt;
              &lt;td&gt;于成龙&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;5&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;0.10566&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;62266–于成龙电视剧&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;2&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;2&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;111943   0.780&lt;/td&gt;
            &lt;/tr&gt;
          &lt;/tbody&gt;
        &lt;/table&gt;
      &lt;/li&gt;
      &lt;li&gt;
        &lt;table&gt;
          &lt;tbody&gt;
            &lt;tr&gt;
              &lt;td&gt;爱恨何欢&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;8&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;0.17406&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;44–爱恨何欢欣欣向荣&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;3&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;10&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;45   0.882&lt;/td&gt;
            &lt;/tr&gt;
          &lt;/tbody&gt;
        &lt;/table&gt;
      &lt;/li&gt;
      &lt;li&gt;
        &lt;table&gt;
          &lt;tbody&gt;
            &lt;tr&gt;
              &lt;td&gt;冷酷总裁的一夜情人&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;5&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;0.10671&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;1920–总裁的囚宠情人&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;2&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;2&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;9933    0.832&lt;/td&gt;
            &lt;/tr&gt;
          &lt;/tbody&gt;
        &lt;/table&gt;
      &lt;/li&gt;
      &lt;li&gt;
        &lt;table&gt;
          &lt;tbody&gt;
            &lt;tr&gt;
              &lt;td&gt;天才魔妃太难追&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;2&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;3&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;2706–天才魔妃我要了&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;5&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;0.10264&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;6309    0.799&lt;/td&gt;
            &lt;/tr&gt;
          &lt;/tbody&gt;
        &lt;/table&gt;
      &lt;/li&gt;
      &lt;li&gt;
        &lt;table&gt;
          &lt;tbody&gt;
            &lt;tr&gt;
              &lt;td&gt;红色鞋子&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;8&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;0.08283&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;52–鞋子&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;3&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;3&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;223   0.779&lt;/td&gt;
            &lt;/tr&gt;
          &lt;/tbody&gt;
        &lt;/table&gt;
      &lt;/li&gt;
      &lt;li&gt;
        &lt;table&gt;
          &lt;tbody&gt;
            &lt;tr&gt;
              &lt;td&gt;夜太黑&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;8&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;0.09022&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;182–夜太黑林忆莲&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;3&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;10&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;394   0.850&lt;/td&gt;
            &lt;/tr&gt;
          &lt;/tbody&gt;
        &lt;/table&gt;
      &lt;/li&gt;
      &lt;li&gt;
        &lt;table&gt;
          &lt;tbody&gt;
            &lt;tr&gt;
              &lt;td&gt;冰火魔厨&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;3&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;3&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;8336–冰火魔厨漫画&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;8&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;0.21497&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;21585   0.866&lt;/td&gt;
            &lt;/tr&gt;
          &lt;/tbody&gt;
        &lt;/table&gt;
      &lt;/li&gt;
      &lt;li&gt;
        &lt;table&gt;
          &lt;tbody&gt;
            &lt;tr&gt;
              &lt;td&gt;洪荒之证道不朽&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;8&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;0.09329&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;244–洪荒不朽&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;8&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;0.10211&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;3093 0.880&lt;/td&gt;
            &lt;/tr&gt;
          &lt;/tbody&gt;
        &lt;/table&gt;
      &lt;/li&gt;
      &lt;li&gt;
        &lt;table&gt;
          &lt;tbody&gt;
            &lt;tr&gt;
              &lt;td&gt;星际全能女王&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;8&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;0.08964&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;14–星际女神攻略&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;3&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;3&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;1335  0.792&lt;/td&gt;
            &lt;/tr&gt;
          &lt;/tbody&gt;
        &lt;/table&gt;
      &lt;/li&gt;
      &lt;li&gt;
        &lt;table&gt;
          &lt;tbody&gt;
            &lt;tr&gt;
              &lt;td&gt;洛天依&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;3&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;5&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;11415–洛天依吸毒&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;8&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;0.22113&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;45463  0.725&lt;/td&gt;
            &lt;/tr&gt;
          &lt;/tbody&gt;
        &lt;/table&gt;
      &lt;/li&gt;
      &lt;li&gt;
        &lt;table&gt;
          &lt;tbody&gt;
            &lt;tr&gt;
              &lt;td&gt;捕鱼大师&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;5&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;0.23225&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;758–捕鱼大师破解版&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;2&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;2&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;854&lt;/td&gt;
            &lt;/tr&gt;
          &lt;/tbody&gt;
        &lt;/table&gt;
      &lt;/li&gt;
      &lt;li&gt;
        &lt;table&gt;
          &lt;tbody&gt;
            &lt;tr&gt;
              &lt;td&gt;蛇蛇大作战无敌版&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;8&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;0.10439&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;2642–贪吃蛇大作战&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;8&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;0.10919&lt;/td&gt;
              &lt;td&gt; &lt;/td&gt;
              &lt;td&gt;35958 0.816&lt;/td&gt;
            &lt;/tr&gt;
          &lt;/tbody&gt;
        &lt;/table&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;排序阶段&quot;&gt;###排序阶段&lt;/h2&gt;

&lt;p&gt;排序阶段一般采用learning to rank,或者ctr预估的模型，这个后续再写，第一版的版本就是按照规则排序的。聚类之后打散的过程，按照常搜在前面的内容&lt;/p&gt;</content><author><name>Start Bootstrap</name></author><category term="推荐" /><category term="短文本" /><category term="去重" /><category term="反垃圾" /><summary type="html">记录在猜你想搜模块的心得</summary></entry><entry><title type="html">源码阅读系列之word2vector</title><link href="http://localhost:4000/blog/blog/2016/12/14/word2vector%E9%98%85%E8%AF%BB.html" rel="alternate" type="text/html" title="源码阅读系列之word2vector" /><published>2016-12-14T00:00:00+08:00</published><updated>2016-12-14T00:00:00+08:00</updated><id>http://localhost:4000/blog/blog/2016/12/14/word2vector%E9%98%85%E8%AF%BB</id><content type="html" xml:base="http://localhost:4000/blog/blog/2016/12/14/word2vector%E9%98%85%E8%AF%BB.html">&lt;p&gt;##基本的参数介绍&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;size&lt;/strong&gt; 输出的vector的维度&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;train&lt;/strong&gt; 训练的文本，已经分好词，按照所有的行分割，一行最多10000个词&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;save-vocab&lt;/strong&gt; 将文本中读取的词出现次数保存&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;read-vacab&lt;/strong&gt; 不从训练的文本读取词次数，直接从文件中读取词的次数&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;debug&lt;/strong&gt; 输出更多信息&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;binary&lt;/strong&gt; 以二进制的方式保存模型，其实就是每个词语对应的vector&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;cbow&lt;/strong&gt;是否使用cbow模型&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;alpha&lt;/strong&gt; 梯度下降的初始学习率，默认的skip-gram 0.025,cbow 0.05,实际是每处理10000个词，   alpha慢慢减小&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;window&lt;/strong&gt; 前后词的窗口最大长度(context(w))的长度，实际会有一个0-window的随机&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;sample&lt;/strong&gt; 采样的时候高频词会有一定的丢弃概率&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;hs&lt;/strong&gt; 是否使用Hierarchical Softmax，默认等于0，不使用&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;negtive&lt;/strong&gt; 负采样词语个数&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;threads&lt;/strong&gt; 线程个数，默认12&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;iter&lt;/strong&gt; 迭代次数，默认是5&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;min-count&lt;/strong&gt; 低于min-count的词语直接丢弃&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;classes&lt;/strong&gt; 输出的是word的类别，不是vector&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;##示例
&lt;strong&gt;./word2vec -train data.txt -output vec.txt -size 200 -window 5 -sample 1e-4 -negative 5 -hs 0 -binary 0 -cbow 1 -iter 3&lt;/strong&gt;&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;tricks 提前算好sigmod函数:&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;``&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;expTable = (real *)malloc((EXP_TABLE_SIZE + 1) * sizeof(real));
for (i = 0; i &amp;lt; EXP_TABLE_SIZE; i++) {
    expTable[i] = exp((i / (real)EXP_TABLE_SIZE * 2 - 1) * MAX_EXP);
    expTable[i] = expTable[i] / (expTable[i] + 1); 
} ``
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;##数据结构介绍
``softmax存储词语的huffuman编码信息&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;struct vocab_word 
{  
  		long long cn; //词频  
  		int *point; //huffman编码对应内节点的路径  
  		char *word, *code, codelen;//huffman编码  
}; `` 数组vocab存取词语信息，每次1000的量增加
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;##函数介绍
  &lt;code class=&quot;highlighter-rouge&quot;&gt;TrainModel()&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;读取每个词语，存入vacab，和vacab_hash中.&lt;/p&gt;

&lt;p&gt;从词表中读入信息:
读入代码:&lt;/p&gt;

&lt;p&gt;``&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;//我觉得此处有问题，为什么没有读入词频
vocab[vocab_size].word = (char *)calloc(length, sizeof(char))
strcpy(vocab[vocab_size].word, word); 
vocab[vocab_size].cn = 0;
vocab_size++;  ``
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;hash采用线性冲突法。顺序往下找:
``&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;hash = GetWordHash(word); 
while (vocab_hash[hash] != -1) hash = (hash + 1) % vocab_hash_size;
vocab_hash[hash] = vocab_size - 1; ``
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;其中hash值的获得很巧妙:
``&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;int GetWordHash(char *word) {  
	unsigned long long a, hash = 0;
	for (a = 0; a &amp;lt; strlen(word); a++) hash = hash * 257 + word[a];
	hash = hash % vocab_hash_size;
	return hash;
} `` 读取词语结束后，``SortVocab``所有的词语排序，然后去掉出现次数小于min_count的词语，然后重新调整vacab_hash,同时开辟存储二叉树的节点，路径的排序
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;从训练级中读取数据:
相同的思路但是需要在词语数目大的时候，删减词语集合
``&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;if (vocab_size &amp;gt; vocab_hash_size * 0.7) ReduceVocab();
//默认min_reduce=1
void ReduceVocab() {
  		int a, b = 0;
  		unsigned int hash;
  		for (a = 0; a &amp;lt; vocab_size; a++) if (vocab[a].cn &amp;gt; min_reduce) {
		vocab[b].cn = vocab[a].cn;
		vocab[b].word = vocab[a].word;
   			 b++;
  		} else free(vocab[a].word);
  		vocab_size = b;
 		for (a = 0; a &amp;lt; vocab_hash_size; a++) vocab_hash[a] = -1; 
  		for (a = 0; a &amp;lt; vocab_size; a++) {
	// Hash will be re-computed, as it is not actual
   			hash = GetWordHash(vocab[a].word);
   		 	while (vocab_hash[hash] != -1) hash = (hash + 1) % vocab_hash_size;
	 	vocab_hash[hash] = a;
  	}
  	fflush(stdout);
 	 min_reduce++;
} ``
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;huffuman树的建树很有意思:
``&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;//实际写一个6,5,4,3,2,1的过程就明白了
void CreateBinaryTree() {
    long long a, b, i, min1i, min2i, pos1, pos2, point[MAX_CODE_LENGTH];
    char code[MAX_CODE_LENGTH];
    long long *count = (long long *)calloc(vocab_size * 2 + 1, sizeof(long long));
    long long *binary = (long long *)calloc(vocab_size * 2 + 1, sizeof(long long));
    long long *parent_node = (long long *)calloc(vocab_size * 2 + 1, sizeof(long long));
    for (a = 0; a &amp;lt; vocab_size; a++) count[a] = vocab[a].cn;
    for (a = vocab_size; a &amp;lt; vocab_size * 2; a++) count[a] = 1e15;
    pos1 = vocab_size - 1;
    pos2 = vocab_size;
    // Following algorithm constructs the Huffman tree by adding one node at a time
    for (a = 0; a &amp;lt; vocab_size - 1; a++) {
        // First, find two smallest nodes 'min1, min2'
        if (pos1 &amp;gt;= 0) {
            if (count[pos1] &amp;lt; count[pos2]) {
                min1i = pos1;
                pos1--;
            } else {
                min1i = pos2;
                pos2++;
            }
       } else {
           min1i = pos2;
           pos2++;
       }   
       if (pos1 &amp;gt;= 0) {
           if (count[pos1] &amp;lt; count[pos2]) {
               min2i = pos1;
               pos1--;
          } else {
              min2i = pos2;
              pos2++;
          }
       } else {
           min2i = pos2;
           pos2++;
       }      
      count[vocab_size + a] = count[min1i] + count[min2i]; //min1,min2为每次组建树        
                                                           //的叶子节点，其中min2i    
                                                           //为较大的那一个叶子节点
      parent_node[min1i] = vocab_size + a;  //存储父子关系
      parent_node[min2i] = vocab_size + a;
      binary[min2i] = 1;   //存储0，1作为路径
   }
   // Now assign binary code to each vocabulary word
   //point太牛逼,point第一位一直为vocab_size-2,为树的根节点，在code中不存储根节点
   
   for (a = 0; a &amp;lt; vocab_size; a++) {
     b = a;
     i = 0;
     while (1) {
        code[i] = binary[b];
        point[i] = b;
        i++;
        b = parent_node[b];
        if (b == vocab_size * 2 - 2) break;
     }
     vocab[a].codelen = i;
     vocab[a].point[0] = vocab_size - 2;
     for (b = 0; b &amp;lt; i; b++) {
         vocab[a].code[i - b - 1] = code[b];   //顺序倒过来，从根节点下一层往下到叶子      
                                               //节点
         vocab[a].point[i - b] = point[b] - vocab_size; //meikandong
     }
  }
  free(count);
  free(binary);
  free(parent_node);
} ``
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;接下来是负抽样的初始化,根据词的个数生成概率数组
``&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;void InitUnigramTable() {
  		int a, i;
  		long long train_words_pow = 0;
  		real d1, power = 0.75;
 		table = (int *)malloc(table_size * sizeof(int));
  		for (a = 0; a &amp;lt; vocab_size; a++) train_words_pow += pow(vocab[a].cn, power);
  		i = 0;
  		d1 = pow(vocab[i].cn, power) / (real)train_words_pow;
  		for (a = 0; a &amp;lt; table_size; a++) {
		table[a] = i;
		if (a / (real)table_size &amp;gt; d1) {
 			 i++;
 			 d1 += pow(vocab[i].cn, power) / (real)train_words_pow;
		}
	   if (i &amp;gt;= vocab_size) i = vocab_size - 1;
  		}
}
//生成table,[0,0,0,0,1,1,1,2] ``
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;训练
l1 ns中表示word在sys1neg中的起始位置，主要用来获取负样本的vector
l2 cbow表示syn1中的非叶子节点的位置,主要用来获取非叶子节点的vector
taget ns中当前词语
label ns中当前词语的label,
neu1  隐藏层的vector
nuu1e 误差累积项&lt;/p&gt;

&lt;p&gt;两个模型cbow和skip-
具体的推理过程可以看&lt;a href=&quot;http://blog.csdn.net/itplus/article/details/37969979&quot; title=&quot;csdn 基于hs的模型&quot;&gt;csdn 基于hs的模型&lt;/a&gt;
其中cbow的模型结构如如下文:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://superashan.github.io/images/word2vector/cbow.png&quot; alt=&quot;cbow结构图&quot; /&gt;&lt;/p&gt;

&lt;p&gt;cbow更新的伪代码如下:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://superashan.github.io/images/word2vector/cbowliucheng.png&quot; alt=&quot;cbow的更新伪码&quot; /&gt;&lt;/p&gt;

&lt;p&gt;看一下使用hs的cbow模型:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;if (cbow) {  //train the cbow architecture
  // in -&amp;gt; hidden
  cw = 0;
  for (a = b; a &amp;lt; window * 2 + 1 - b; a++) if (a != window) {   //context(w)输入上下文相加得到隐藏层
    c = sentence_position - window + a;
    if (c &amp;lt; 0) continue;
    if (c &amp;gt;= sentence_length) continue;
    last_word = sen[c];
    if (last_word == -1) continue;
    for (c = 0; c &amp;lt; layer1_size; c++) neu1[c] += syn0[c + last_word * layer1_size];
    cw++;
  }   
  if (cw) {
    for (c = 0; c &amp;lt; layer1_size; c++) neu1[c] /= cw;   //隐藏层的变量除以输入的变量个数
    if (hs) for (d = 0; d &amp;lt; vocab[word].codelen; d++) {
      f = 0;
      l2 = vocab[word].point[d] * layer1_size;  //非叶子节点的位置
      // Propagate hidden -&amp;gt; output
      for (c = 0; c &amp;lt; layer1_size; c++) f += neu1[c] * syn1[c + l2];   //逻辑函数的因变量,Xw*参数,即非叶子节点向量
      if (f &amp;lt;= -MAX_EXP) continue;
      else if (f &amp;gt;= MAX_EXP) continue;
      else f = expTable[(int)((f + MAX_EXP) * (EXP_TABLE_SIZE / MAX_EXP / 2))];  //分类的概率值
      // 'g' is the gradient multiplied by the learning rate
      g = (1 - vocab[word].code[d] - f) * alpha;    
      // Propagate errors output -&amp;gt; hidden
      for (c = 0; c &amp;lt; layer1_size; c++) neu1e[c] += g * syn1[c + l2];  //误差累积项，用来更新词向量，上下文词的向量
      // Learn weights hidden -&amp;gt; output
      for (c = 0; c &amp;lt; layer1_size; c++) syn1[c + l2] += g * neu1[c];   //更新非叶子节点的向量，即参数向量
    }   
   //文中此处为负抽样的代码
   //更新所有上下文词的词向量
    // hidden -&amp;gt; in
    for (a = b; a &amp;lt; window * 2 + 1 - b; a++) if (a != window) {
      c = sentence_position - window + a;
      if (c &amp;lt; 0) continue;
      if (c &amp;gt;= sentence_length) continue;
      last_word = sen[c];
      if (last_word == -1) continue;
      for (c = 0; c &amp;lt; layer1_size; c++) syn0[c + last_word * layer1_size] += neu1e[c]; //这一步更新
    }
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;负抽样的代码如下:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;      // NEGATIVE SAMPLING
    if (negative &amp;gt; 0) for (d = 0; d &amp;lt; negative + 1; d++) {
      if (d == 0) {
        target = word;
        label = 1;
      } else {
        next_random = next_random * (unsigned long long)25214903917 + 11; 
        target = table[(next_random &amp;gt;&amp;gt; 16) % table_size];
        if (target == 0) target = next_random % (vocab_size - 1) + 1;
        if (target == word) continue;
        label = 0;
      }   
      l2 = target * layer1_size;
      f = 0;
      for (c = 0; c &amp;lt; layer1_size; c++) f += neu1[c] * syn1neg[c + l2];
      if (f &amp;gt; MAX_EXP) g = (label - 1) * alpha;
      else if (f &amp;lt; -MAX_EXP) g = (label - 0) * alpha;
      else g = (label - expTable[(int)((f + MAX_EXP) * (EXP_TABLE_SIZE / MAX_EXP / 2))]) * alpha;
      for (c = 0; c &amp;lt; layer1_size; c++) neu1e[c] += g * syn1neg[c + l2];
      for (c = 0; c &amp;lt; layer1_size; c++) syn1neg[c + l2] += g * neu1[c];
    }   
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;附录，推导过程：
负抽样方法模型推导见:
&lt;a href=&quot;http://blog.csdn.net/itplus/article/details/37998797&quot;&gt;word2vector中的负抽样&lt;/a&gt;
大致思路为条件为上下文，正确的词语概率大，随机负抽样的概率小&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://superashan.github.io/images/word2vector/negtive1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://superashan.github.io/images/word2vector/negtive2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://superashan.github.io/images/word2vector/negtive3.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://superashan.github.io/images/word2vector/negtive4.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;cbow的推导过程:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://superashan.github.io/images/word2vector/cbow_1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://superashan.github.io/images/word2vector/cbow_1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://superashan.github.io/images/word2vector/cbow_1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://superashan.github.io/images/word2vector/cbow_1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;写在结尾，以上推导过程来自
&lt;a href=&quot;http://my.csdn.net/peghoty&quot; title=&quot;csdn 皮果提博客&quot;&gt;csdn 皮果提博客&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;结尾十问：&lt;strong&gt;&lt;em&gt;每次写完一个模型或者一个算法都要有问题&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;&lt;em&gt;wordtovecotor训练的词向量区别于one-hot模型的地方有哪些？&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;

    &lt;p&gt;语义特性。wordtovecotr训练的词向量表示的是语义空间的点，点之间的远近关系通过词之间的共现关系训练得到。&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;&lt;em&gt;训练方法上，为什么负抽样可以得到和window方法相似的效果？&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;

    &lt;p&gt;训练空间上有语义传播性，所以在区分的不同语义的内容时，只需要区分一个就好。例如a和b关系较远，b和c关系较远，则a和c的关系也较远，这个负抽样也能达到效果的原因&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;&lt;em&gt;wordtovector中如何霍夫曼树是为什么可以实现等同softmax的作用？&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;

    &lt;p&gt;以三层霍夫曼树为例，每次拆分概率为p,q,r.最后叶子节点的概率和为: p.q+p(1-q)+(1-p)r+(1-p)(1-r)=1&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;&lt;em&gt;wordtovector中词向量为什么可以表示语义空间的点？&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;

    &lt;p&gt;霍夫曼树种每个节点的分裂表示的语义的一次分类，则经过整棵树的分类之后就到了叶子节点就是语义空间的一个点&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;&lt;em&gt;wordtovector中对高频词和低频词处理的原则，以及为什么这么做?&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;

    &lt;p&gt;低频词按照阈值丢掉，如果内容加载不下，提高阈值。
高频词按照一定的概率丢弃。
低频词本来就无法训练出来语义特征
高频词按照论文的解释，高频词由于共现的词很多，语义特征不具有区分性。比如训练巴黎的时候，更希望和纽约一块训练，而不是和“的”一块儿训练&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;</content><author><name>Start Bootstrap</name></author><category term="word2vector" /><category term="wordtovector" /><category term="词向量" /><category term="源码" /><category term="源代码" /><category term="负抽样" /><category term="cbow" /><summary type="html">根据word2vector的源码介绍其原理以及如何应用</summary></entry></feed>